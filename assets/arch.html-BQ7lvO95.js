import{_ as a,c as s,b as n,o as t}from"./app-Bn9GZJrW.js";const i={};function l(r,e){return t(),s("div",null,e[0]||(e[0]=[n(`<h1 id="arch-linux" tabindex="-1"><a class="header-anchor" href="#arch-linux"><span>Arch Linux</span></a></h1><p><em>These instructions were created with the 2020-12-01 Arch version and will likely be out of sync with the latest rolling release of Arch, so this is intended to be a rough guide on how to install TaxonWorks. Additional steps and troubleshooting will likely be required.</em></p><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h2><ol><li>Assumes a clean install of the OS.</li><li>Copy and paste each line, this is not intended to run as a shell script.</li><li>Carefully read the instructions before each line before exectuting the line.</li></ol><h2 id="system-requirements-recommended" tabindex="-1"><a class="header-anchor" href="#system-requirements-recommended"><span>System Requirements (Recommended)</span></a></h2><ol><li>Memory: 8 GB RAM</li><li>Storage: 32 GB (when testing with Sandbox data)</li></ol><h2 id="installation-instructions" tabindex="-1"><a class="header-anchor" href="#installation-instructions"><span>Installation Instructions</span></a></h2><p>Open a terminal and update .</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo pacman -Syu</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Reboot the machine</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo reboot</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Reopen a terminal.</p><p>Install required packages.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo pacman -S postgresql postgis imagemagick tesseract git meld curl cmake nodejs npm pkgconf base-devel tar gzip diffutils python-psycopg2 graphviz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>For Tesseract OCR, you also need to install your desired <a href="https://www.archlinux.org/packages/?sort=&amp;q=tesseract-data-&amp;maintainer=&amp;flagged=" target="_blank" rel="noopener noreferrer">language data packages</a>. For example:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo pacman -S tesseract-data-eng</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Enable the postgresql service.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo systemctl enable postgresql.service</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Initialize the postgresql database.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo -u postgres initdb -D /var/lib/postgres/data</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Start the postgresql service.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo systemctl start postgresql.service</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>When prompted do not supply a password. See below, the password must match <code>config/database.yml</code> if provided.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo -u postgres createuser -s -d -P taxonworks_development</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Change permissions for posgresql, you are changing &#39;peer&#39; to &#39;trust&#39; for the matched line.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo sed -i.bak &#39;s/local\\s*all\\s*all\\s*peer/local all all trust/&#39;  /var/lib/postgres/data/pg_hba.conf</span>
<span class="line">sudo systemctl restart postgresql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Install RVM</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3 7D2BAF1CF37B13E2069D6956105BD0E739499BDB</span>
<span class="line"></span>
<span class="line">curl -sSL https://get.rvm.io | bash -s stable --ruby</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To use RVM, you need to run the shell in login mode, which for bash you can do with:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">bash --login</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If you are using zsh instead of bash as your shell, you can do:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">zsh --login</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You may optionally want to Google how to configure your terminal client to use login mode, so that you do not have to manually enter login mode.</p><p>Setup TaxonWorks project repository:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">mkdir Projects</span>
<span class="line">cd Projects</span>
<span class="line">git clone https://github.com/SpeciesFileGroup/taxonworks.git</span>
<span class="line">cd taxonworks</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When you do <code>cd taxonworks</code> you will see a message regarding a particular version of Ruby. Install that version of Ruby with the command provided in the terminal. It will look something like: <code>rvm install 3.1.2</code>.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">cd . # Refreshes rvm to pick up recently installed ruby above</span>
<span class="line">gem install bundler</span>
<span class="line"></span>
<span class="line">bundle</span>
<span class="line">npm install</span>
<span class="line"></span>
<span class="line">cp config/database.yml.example config/database.yml</span>
<span class="line">cp config/secrets.yml.example config/secrets.yml</span>
<span class="line"></span>
<span class="line">bundle exec rake db:create &amp;&amp; bundle exec bin/rails db:environment:set RAILS_ENV=development</span>
<span class="line"></span>
<span class="line">bundle exec rake db:schema:load &amp;&amp; bundle exec rake db:test:prepare</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Run the test suite, you may see some failures, but the vast majority should pass.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">bundle exec rake</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If you receive any migration related errors when you run test suite, use the following command before proceeding ahead:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">bundle exec rake db:migrate</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now proceed ahead to deploy the development server.</p><h2 id="deploy-the-development-server" tabindex="-1"><a class="header-anchor" href="#deploy-the-development-server"><span>Deploy the development server</span></a></h2><p>Before starting rails server it is recommended -but not strictly required- to start the Webpack development server first on a separate terminal so assets are rebuilt faster when developing:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">./bin/shakapacker-dev-server</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Alternatively you may run <code>bundle exec rails assets:precompile</code> (but any change you make will take longer to materialize when browsing).</p><p>Start the web server with the following command: <em>(If you followed the recommendation above then wait for assets compilation to finish before proceeding)</em></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">bundle exec rails s</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Navigate in your browser to 127.0.0.1:3000. To stop the development server return to the terminal window and type <code>ctrl-c</code>.</p><h2 id="optional" tabindex="-1"><a class="header-anchor" href="#optional"><span>Optional</span></a></h2><p>If you want to populate the development server with some dummy accounts do this:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">bundle exec rake db:seed</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The username for the dummy account is <code>user@example.com</code> and password is <code>taxonworks</code>. Note, this account is a regular user and does not have admin privileges. For admin privileges use <code>admin@example.com</code> (same password).</p><h2 id="required-for-development" tabindex="-1"><a class="header-anchor" href="#required-for-development"><span>Required for development</span></a></h2><p>If you plan on coding and committing back code you&#39;ll have had to configure git, at minimum do this</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">git config --global user.name &quot;Jane Doe&quot;</span>
<span class="line">git config --global user.email developer@example.com</span>
<span class="line">git config --global merge.tool meld</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="see-also" tabindex="-1"><a class="header-anchor" href="#see-also"><span>See also</span></a></h2><ul><li><a href="https://github.com/SpeciesFileGroup/install_taxonworks/blob/master/development/native/tuning_postgres_for_development.md" target="_blank" rel="noopener noreferrer">tuning_postgres_for_development.md</a></li></ul><h2 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting"><span>Troubleshooting</span></a></h2><h3 id="may-2025-bundle-fails-to-install-ruby-prof-1-7-1-with-error-unknown-type-name-bool" tabindex="-1"><a class="header-anchor" href="#may-2025-bundle-fails-to-install-ruby-prof-1-7-1-with-error-unknown-type-name-bool"><span>May 2025: bundle fails to install ruby-prof 1.7.1 with error: unknown type name ‘bool’</span></a></h3><p>Configure bundler to use --with-cflags:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">bundle config build.ruby-prof --with-cflags=&quot;-DHAVE_STDBOOL_H&quot; &amp;&amp; bundle</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Or set ruby-prof version 1.7.2 in the Gemfile and run <code>bundle</code>.</p><h3 id="selenium-tests" tabindex="-1"><a class="header-anchor" href="#selenium-tests"><span>Selenium tests</span></a></h3><p>In order for selenium tests to work, it may be necessary to add the following config to the <code>taxonworks/config/application_settings.yml</code> file:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">test</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">selenium</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">headless</span><span class="token punctuation">:</span> <span class="token boolean important">false</span></span>
<span class="line">    <span class="token key atrule">browser</span><span class="token punctuation">:</span> <span class="token string">&#39;firefox&#39;</span></span>
<span class="line">    <span class="token key atrule">firefox_binary_path</span><span class="token punctuation">:</span> <span class="token string">&#39;/usr/bin/firefox&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="imagemagick-and-rmagick" tabindex="-1"><a class="header-anchor" href="#imagemagick-and-rmagick"><span>ImageMagick and RMagick</span></a></h3><p>If you get the following message:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Gem Load Error is: This installation of RMagick was configured with ImageMagick 7.0.10 but ImageMagick 7.0.11-1 is in use.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Reinstall rmagick:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">bundle pristine rmagick</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="database-doesn-t-exist" tabindex="-1"><a class="header-anchor" href="#database-doesn-t-exist"><span>Database doesn&#39;t exist</span></a></h3><p>If you are getting the following message running <code>bundle exec rake db:create</code>:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">PG::ConnectionBad: FATAL: database &quot;taxonworks_development&quot; does not exist error.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You will have to create the database using postgresql console:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo -u postgres psql</span>
<span class="line">create database taxonworks_development;</span>
<span class="line">grant all privileges on database taxonworks_development to taxonworks_development;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="database-collation-version-mismatch" tabindex="-1"><a class="header-anchor" href="#database-collation-version-mismatch"><span>Database collation version mismatch</span></a></h3><p>If you are getting a database collation mismatch when restoring a database dump:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">The database was created using collation version 2.36, but the operating system provides version 2.37.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>It may be necessary to <a href="https://wiki.archlinux.org/title/PostgreSQL" target="_blank" rel="noopener noreferrer">re-initalize postgresql with a locale that doesn&#39;t depend on collations compiled with glibc</a> with:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">sudo -u postgres initdb --locale=C.UTF-8 --encoding=UTF8 -D /var/lib/postgres/data</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,81)]))}const o=a(i,[["render",l],["__file","arch.html.vue"]]),p=JSON.parse(`{"path":"/develop/Install/Development/Native/arch.html","title":"Arch Linux","lang":"en-US","frontmatter":{"sidebarPosition":2},"headers":[{"level":2,"title":"Overview","slug":"overview","link":"#overview","children":[]},{"level":2,"title":"System Requirements (Recommended)","slug":"system-requirements-recommended","link":"#system-requirements-recommended","children":[]},{"level":2,"title":"Installation Instructions","slug":"installation-instructions","link":"#installation-instructions","children":[]},{"level":2,"title":"Deploy the development server","slug":"deploy-the-development-server","link":"#deploy-the-development-server","children":[]},{"level":2,"title":"Optional","slug":"optional","link":"#optional","children":[]},{"level":2,"title":"Required for development","slug":"required-for-development","link":"#required-for-development","children":[]},{"level":2,"title":"See also","slug":"see-also","link":"#see-also","children":[]},{"level":2,"title":"Troubleshooting","slug":"troubleshooting","link":"#troubleshooting","children":[{"level":3,"title":"May 2025: bundle fails to install ruby-prof 1.7.1 with error: unknown type name ‘bool’","slug":"may-2025-bundle-fails-to-install-ruby-prof-1-7-1-with-error-unknown-type-name-bool","link":"#may-2025-bundle-fails-to-install-ruby-prof-1-7-1-with-error-unknown-type-name-bool","children":[]},{"level":3,"title":"Selenium tests","slug":"selenium-tests","link":"#selenium-tests","children":[]},{"level":3,"title":"ImageMagick and RMagick","slug":"imagemagick-and-rmagick","link":"#imagemagick-and-rmagick","children":[]},{"level":3,"title":"Database doesn't exist","slug":"database-doesn-t-exist","link":"#database-doesn-t-exist","children":[]},{"level":3,"title":"Database collation version mismatch","slug":"database-collation-version-mismatch","link":"#database-collation-version-mismatch","children":[]}]}],"git":{"updatedTime":1748383974000,"contributors":[{"name":"Geoff Ower","email":"gdower@illinois.edu","commits":2,"url":"https://github.com/Geoff Ower"},{"name":"mjy","email":"diapriid@gmail.com","commits":1,"url":"https://github.com/mjy"}]},"filePathRelative":"develop/Install/Development/Native/arch.md"}`);export{o as comp,p as data};
