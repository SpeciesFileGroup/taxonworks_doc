import{_ as a,c as s,b as n,o as i}from"./app-Bn9GZJrW.js";const t={};function r(l,e){return i(),s("div",null,e[0]||(e[0]=[n(`<h1 id="macos" tabindex="-1"><a class="header-anchor" href="#macos"><span>macOS</span></a></h1><p><em>Last tested Jun 18 2024 on MacOS Sonoma 14.5</em></p><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h2><ol><li>Assumes a clean install of the OS.</li><li>Carefully read the instructions for each line prior to exectuting each line.</li><li>Copy and paste each line. These instructions are not intended to run as a shell script.</li><li>TaxonWorks developers generally adopt the convention of creating a <code>src</code> directory under their home directory into which the TaxonWorks repository will be cloned.</li></ol><h2 id="instructions" tabindex="-1"><a class="header-anchor" href="#instructions"><span>Instructions</span></a></h2><p><em>Do not skip steps. See the Troubleshooting section if you hit errors, particularly with proj related issues.</em></p><ul><li><p><a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Install Homebrew</a></p></li><li><p><a href="https://rvm.io/rvm/install" target="_blank" rel="noopener noreferrer">Install RVM</a></p></li><li><p>Install some other packages:</p></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">brew install postgis</span>
<span class="line">brew install proj # Force newer</span>
<span class="line">brew services restart postgresql</span>
<span class="line">brew install imagemagick</span>
<span class="line">brew install tesseract</span>
<span class="line">brew install node</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>Installing postgis via the Postgres app is also viable, though doing so will require alternate build commands downstream.</p></div><p>Close the terminal and open a new one. This will use the new environment created by the previous instructions.</p><p>Clone (download) the source code from Github: Navigate to the directory you want your TaxonWorks folder in (change directory as appropriate, here we have a <code>src</code> folder in the Users&#39; home:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">cd ~/src</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">git clone https://github.com/SpeciesFileGroup/taxonworks.git</span>
<span class="line">cd taxonworks</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>At this point you may see a message regarding a particular version of Ruby. Install that version of Ruby with the commands provided below in the terminal. It will look something like this (for more, e.g. to set as default <a href="https://rvm.io/rubies/default" target="_blank" rel="noopener noreferrer">see here</a>):</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">rvm install 3.3.1</span>
<span class="line">rvm --default 3.3.1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This installs the Ruby version currently being used, and makes it the default. At this point, you can verify this with <code>rvm list</code> which will indicate all Ruby versions managed by RVM and their status.</p><p>Now it is time to install the required gems and npm dependencies. Inside the <code>taxonworks</code> directory do</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">gem install bundler</span>
<span class="line">bundle</span>
<span class="line">npm install</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Create a postgres role for taxonworks (from terminal), and setup database config</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">createuser -s -d -P taxonworks_development (requests password) &lt;- provide alternative for existing user)</span>
<span class="line">cp config/database.yml.example config/database.yml</span>
<span class="line">cp config/secrets.yml.example config/secrets.yml</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you supplied a password in the previous step please edit database.yml accordingly.</p><h3 id="prepare-the-database" tabindex="-1"><a class="header-anchor" href="#prepare-the-database"><span>Prepare the database</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">rake db:create</span>
<span class="line">rake db:migrate</span>
<span class="line">rake db:test:prepare</span>
<span class="line">rake db:seed:development project_id=1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Install <a href="https://www.firefox.com/" target="_blank" rel="noopener noreferrer">Firefox</a> browser.</p><p>Now <code>rake</code> should run tests.</p><p>At this point you may use <code>rake db:seed</code> to initialize the database for the development environment, or, more typically, you&#39;ll load a snapshot of a dumped copy of the data with <code>rake tw:db:restore file=/path/to/dump.sql</code>.</p><h3 id="start-the-servers" tabindex="-1"><a class="header-anchor" href="#start-the-servers"><span>Start the servers</span></a></h3><p>You need to have two servers running:</p><p>Webpack (must run in a separate terminal window -- use with caution)</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">./bin/shakapacker-dev-server</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Rails</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">rails server</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="see-the-app" tabindex="-1"><a class="header-anchor" href="#see-the-app"><span>See the app</span></a></h3><p>Visit http://localhost:3000/ to get started. You should see the sign-in page. Since there are no <code>users</code> at this point, these must be provisioned.</p><div class="language-apple line-numbers-mode" data-highlighter="prismjs" data-ext="apple" data-title="apple"><pre><code><span class="line">rails console</span>
<span class="line">rake db:seed</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>The username for the dummy account is <code>user@example.com</code> and password is <code>taxonworks</code>. Note, this account is a regular user and does not have admin privileges. For admin privileges use <code>admin@example.com</code> with the password <code>taxonworks</code>.</p><h2 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting"><span>Troubleshooting</span></a></h2><p><em>Errors are listed in percieved likelihood of being hit</em></p><h3 id="problems-with-certificates-when-running-rvm-install-on-big-sur-11-7-9" tabindex="-1"><a class="header-anchor" href="#problems-with-certificates-when-running-rvm-install-on-big-sur-11-7-9"><span>Problems with certificates when running rvm install on Big Sur 11.7.9</span></a></h3><p>Running with <a href="https://github.com/rvm/rvm/issues/5240#issuecomment-1653046500" target="_blank" rel="noopener noreferrer">openssl prefix</a> fixes the issue:</p><p>rvm reinstall 3.2.2 --with-openssl-dir=$(brew --prefix openssl) --with-readline-dir=$(brew --prefix readline) --with-libyaml-dir=$(brew --prefix libyaml) --disable-dtrace --disable-docs</p><h3 id="random-gems-failing" tabindex="-1"><a class="header-anchor" href="#random-gems-failing"><span>Random gems failing</span></a></h3><p>Inside the TaxonWorks directory rebuild all your gems with <code>bundle pristine</code></p><h3 id="error-regarding-rmagick" tabindex="-1"><a class="header-anchor" href="#error-regarding-rmagick"><span>Error regarding rmagick</span></a></h3><p>rmagick currently requires a previous version of image magick (see the @6 above). If you an error regarding rmagick, please run the next two commands and run bundle again:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">brew uninstall imagemagick</span>
<span class="line">brew install imagemagick@6</span>
<span class="line">export PKG_CONFIG_PATH=/usr/local/Cellar/imagemagick@6/6.9.9-36/lib/pkgconfig</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To test succesfull install run <code>identify</code> in your terminal, if you get the help docs you should be ok. If brew tells you the package is installed but <code>identify</code> does not work try <code>brew link imagemagick@6 --force</code>.</p><h3 id="imagemagick-6-with-mojave" tabindex="-1"><a class="header-anchor" href="#imagemagick-6-with-mojave"><span>Imagemagick@6 with Mojave</span></a></h3><p>May be an issue. See <a href="https://github.com/rmagick/rmagick/issues/1153#issuecomment-598203790" target="_blank" rel="noopener noreferrer">here</a>. Using the &#39;mv&#39; allowed <code>rmagick</code> to successfully install.</p><h2 id="rmagick-gem-magickcore-was-not-found" tabindex="-1"><a class="header-anchor" href="#rmagick-gem-magickcore-was-not-found"><span>rmagick gem &quot;MagickCore was not found&quot;</span></a></h2><p>You may have a problem installing the gem <code>rmagick</code> having to do with <code>Package MagickCore was not found in the pkg-config search path.</code>. If so so:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">find /usr/local -name MagickCore.pc\`</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>and use the result in the following line:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">PKG_CONFIG_PATH=&#39;&lt;remove the file name and extension from what you got as a result of the &#39;find&#39; line and use that&gt;&#39; gem install rmagick</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="proj4-error" tabindex="-1"><a class="header-anchor" href="#proj4-error"><span>Proj4 error</span></a></h3><p><em>Error is deprecated and should no longer be hit.</em></p><p>This is now a known error for postgis 11.2</p><p>If you see an error regarding Proj4 rebuilding it against the latest rgeo-proj4 5.2.0 should resolve the issue, execution order matters!</p><p>See this issue for using 5.2.0 instead of brew&#39;s 6.0.0: https://github.com/rgeo/rgeo-proj4/issues/4. Follow the instructions for the first two lines, you&#39;ll need to unlink as well likely (message from first tap command). Then repeat below.</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">gem uninstall rgeo</span>
<span class="line">gem uninstall rgeo-proj4</span>
<span class="line">gem install rgeo-proj4</span>
<span class="line">bundle install</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rvm-out-of-date-on-bundle-install" tabindex="-1"><a class="header-anchor" href="#rvm-out-of-date-on-bundle-install"><span>RVM out of date on <code>bundle install</code></span></a></h3><p>If bundle install results in the following sequence:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">Warning, new version of rvm available &#39;1.29.10-next&#39;, you are using older version &#39;1.29.4&#39;.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If the upgrade sequence documented on <code>rvm</code> fails just nuke your environment (see <code>implode</code> commands) then redo rvm and gem related instructions above.</p>`,65)]))}const d=a(t,[["render",r],["__file","macos.html.vue"]]),c=JSON.parse('{"path":"/develop/Install/Development/Native/macos.html","title":"macOS","lang":"en-US","frontmatter":{"sidebarPosition":3},"headers":[{"level":2,"title":"Overview","slug":"overview","link":"#overview","children":[]},{"level":2,"title":"Instructions","slug":"instructions","link":"#instructions","children":[{"level":3,"title":"Prepare the database","slug":"prepare-the-database","link":"#prepare-the-database","children":[]},{"level":3,"title":"Start the servers","slug":"start-the-servers","link":"#start-the-servers","children":[]},{"level":3,"title":"See the app","slug":"see-the-app","link":"#see-the-app","children":[]}]},{"level":2,"title":"Troubleshooting","slug":"troubleshooting","link":"#troubleshooting","children":[{"level":3,"title":"Problems with certificates when running rvm install on Big Sur 11.7.9","slug":"problems-with-certificates-when-running-rvm-install-on-big-sur-11-7-9","link":"#problems-with-certificates-when-running-rvm-install-on-big-sur-11-7-9","children":[]},{"level":3,"title":"Random gems failing","slug":"random-gems-failing","link":"#random-gems-failing","children":[]},{"level":3,"title":"Error regarding rmagick","slug":"error-regarding-rmagick","link":"#error-regarding-rmagick","children":[]},{"level":3,"title":"Imagemagick@6 with Mojave","slug":"imagemagick-6-with-mojave","link":"#imagemagick-6-with-mojave","children":[]}]},{"level":2,"title":"rmagick gem \\"MagickCore was not found\\"","slug":"rmagick-gem-magickcore-was-not-found","link":"#rmagick-gem-magickcore-was-not-found","children":[{"level":3,"title":"Proj4 error","slug":"proj4-error","link":"#proj4-error","children":[]},{"level":3,"title":"RVM out of date on bundle install","slug":"rvm-out-of-date-on-bundle-install","link":"#rvm-out-of-date-on-bundle-install","children":[]}]}],"git":{"updatedTime":1730999918000,"contributors":[{"name":"mjy","email":"diapriid@gmail.com","commits":1,"url":"https://github.com/mjy"}]},"filePathRelative":"develop/Install/Development/Native/macos.md"}');export{d as comp,c as data};
